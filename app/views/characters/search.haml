= render 'search/breadcrumbs'

%table.search-collapsible
  %thead
    %tr
      %th.search-params-header
        Search Characters
        - if @search_results
          = "- #{@search_results.total_entries} results"
      %th.search-results-header
        - if @search_results
          = render 'posts/paginator', paginated: @search_results, no_per: true
  %tbody
    %tr
      %td.search-box
        = form_tag search_characters_path, method: :get do
          %table.search-form
            %tr
              %td= label_tag :author_id, 'Author'
              %td= select_tag :author_id, options_from_collection_for_select(@users, :id, :username, params[:author_id]),
                { class: 'chosen-select', prompt: '— Choose Author —' }
            %tr
              %td= label_tag :template_id, 'Template'
              %td= select_tag :template_id, options_from_collection_for_select(@templates, :id, :name, params[:template_id]),
                { class: 'chosen-select', prompt: '— Choose Template —' }
            %tr
              %td= label_tag :setting_id, 'Setting'
              %td= select_tag :setting_id, options_from_collection_for_select(@settings, :id, :name, params[:setting_id]), { class: 'chosen-select', prompt: '— Choose Setting —' }
            %tr
              %td= label_tag :name, 'Name'
              %td= text_field_tag :name, params[:name], style: 'width: 100%; margin: 5px 0px;'
            %tr
              %td= label_tag :pb, 'Facecast'
              %td= text_field_tag :pb, params[:pb], style: 'width: 100%; margin: 5px 0px;'
            %tr
              %td
              %td
                Searching for name in:
                %br
                = check_box_tag :search_name, true, params[:commit] ? params[:search_name] : true, { class: 'vmid no-margin', style: 'margin-bottom: 3px;' }
                = label_tag :search_name, "Name"
                %br
                = check_box_tag :search_screenname, true, params[:commit] ? params[:search_screenname] : true, { class: 'vmid no-margin', style: 'margin-bottom: 3px;' }
                = label_tag :search_screenname, "Screenname"
                %br
                = check_box_tag :search_nickname, true, params[:commit] ? params[:search_nickname] : true, { class: 'vmid no-margin', style: 'margin-bottom: 3px;' }
                = label_tag :search_nickname, "Nickname"
                %br
                = check_box_tag :search_aliases, true, params[:commit] ? params[:search_aliases] : true, { class: 'vmid no-margin', style: 'margin-bottom: 3px;' }
                = label_tag :search_aliases, "Aliases"
            %tr
              %td.centered{colspan: 2}= submit_tag "Search", class: 'button'
      %td.vtop
        - if @search_results.present?
          %table
            = render 'characters/list_section', characters: @search_results, name: nil, show_user: true, show_settings: true, show_template: true, hide_buttons: true
